<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è–èª•è€äººçš„æ•¸å­¸ç¦®ç‰©åº—</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap');
        
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #1a4731; /* Christmas Green */
            background-image: radial-gradient(#ffffff 1px, transparent 1px), radial-gradient(#ffffff 1px, transparent 1px);
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
        }

        .snow-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .snowflake {
            position: absolute;
            top: -10px;
            color: white;
            animation: fall linear forwards;
        }

        @keyframes fall {
            to {
                transform: translateY(100vh);
            }
        }

        .gift-card {
            transition: all 0.3s ease;
        }
        
        .gift-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3);
        }

        .gift-card:active {
            transform: scale(0.95);
        }

        .chalkboard {
            background-color: #2b4a3b;
            border: 8px solid #8b4513;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
            font-family: 'Courier New', Courier, monospace;
        }

        .calculator-text {
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }
    </style>
</head>
<body class="min-h-screen pb-10">

    <!-- Snow Effect Container -->
    <div id="snow-container" class="snow-container"></div>

    <div class="container mx-auto px-4 py-8 relative z-10">
        
        <!-- Header -->
        <header class="text-center mb-8 bg-red-700 rounded-3xl p-6 shadow-xl border-4 border-yellow-400">
            <h1 class="text-3xl md:text-5xl font-bold text-white mb-2">ğŸ… è–èª•è€äººçš„æ•¸å­¸ç¦®ç‰©åº— ğŸ</h1>
            <p class="text-yellow-200 text-lg">çµ¦æ˜æŸ”çš„9ä½åŒå­¸ï¼šé¸ç¦®ç‰©ï¼Œå­¸åŠ æ³•ï¼é ç®— $100 ä»¥å…§å–”ï¼</p>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            
            <!-- Gift Shop Area (Left) -->
            <div class="lg:col-span-2">
                <div class="bg-white/90 backdrop-blur-sm rounded-2xl p-6 shadow-lg">
                    <h2 class="text-2xl font-bold text-red-700 mb-4 flex items-center">
                        <i class="fas fa-gift mr-2"></i> é»æ“Šç¦®ç‰©åŠ å…¥è³¼ç‰©è»Š
                    </h2>
                    
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-4" id="gift-grid">
                        <!-- Gifts will be injected here by JS -->
                    </div>
                </div>
            </div>

            <!-- Calculation Area (Right) -->
            <div class="lg:col-span-1">
                <div class="sticky top-4">
                    <!-- Receipt / Calculation Board -->
                    <div class="chalkboard rounded-xl p-6 text-white mb-4">
                        <h3 class="text-xl font-bold text-yellow-400 mb-4 border-b-2 border-white/30 pb-2">
                            ğŸ“ æ•¸å­¸ç®—å¼æ¿
                        </h3>
                        
                        <!-- Selected Items List -->
                        <div id="selected-items-list" class="space-y-2 mb-4 text-sm min-h-[100px] max-h-[300px] overflow-y-auto">
                            <p class="text-gray-300 italic text-center py-4">é‚„æ²’é¸ç¦®ç‰©å–”...</p>
                        </div>

                        <!-- The Equation -->
                        <div class="bg-black/30 rounded p-3 mb-4 overflow-x-auto whitespace-nowrap">
                            <span class="text-gray-400 text-xs block mb-1">ç®—å¼ï¼š</span>
                            <div id="math-equation" class="text-lg font-mono tracking-wider calculator-text text-green-300">
                                0
                            </div>
                        </div>

                        <!-- Total Price -->
                        <div class="flex justify-between items-end border-t-2 border-white/50 pt-4">
                            <span class="text-lg">ç¸½é‡‘é¡:</span>
                            <span id="total-price" class="text-4xl font-bold text-yellow-400">$0</span>
                        </div>

                        <!-- Budget Warning -->
                        <div id="budget-status" class="mt-4 text-center text-sm font-bold py-2 px-4 rounded bg-green-600">
                            é ç®—å……è¶³ ($100 ä»¥å…§)
                        </div>
                    </div>

                    <!-- Actions -->
                    <div class="grid grid-cols-2 gap-4">
                        <button onclick="resetCart()" class="bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 px-4 rounded-xl transition shadow-lg flex items-center justify-center">
                            <i class="fas fa-trash-alt mr-2"></i> æ¸…ç©º
                        </button>
                        <button onclick="checkout()" class="bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-4 rounded-xl transition shadow-lg flex items-center justify-center animate-pulse">
                            <i class="fas fa-check-circle mr-2"></i> çµå¸³
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Celebration Modal -->
    <div id="modal" class="fixed inset-0 bg-black/80 hidden items-center justify-center z-50 p-4">
        <div class="bg-white rounded-3xl p-8 max-w-md w-full text-center relative overflow-hidden">
            <div class="absolute top-0 left-0 w-full h-4 bg-gradient-to-r from-red-500 via-green-500 to-red-500"></div>
            <i class="fas fa-sleigh text-6xl text-red-600 mb-4"></i>
            <h2 class="text-3xl font-bold text-gray-800 mb-2">Ho Ho Ho! è³¼è²·æˆåŠŸ!</h2>
            <p class="text-xl text-gray-600 mb-6">å¦‚æœä½ é€™ä»½ç¦®ç‰©æ˜¯é€çµ¦åŒå­¸çš„ï¼Œ<br>æ¯äººå¹³å‡èŠ±è²»ï¼š<br><span class="text-3xl font-bold text-green-600" id="modal-total"></span></p>
            <p class="text-sm text-gray-500 mb-6">æ•¸å­¸åŠ æ³•ç®—å¾—çœŸå¥½ï¼</p>
            <button onclick="closeModal()" class="bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-8 rounded-full text-lg shadow-lg transform transition hover:scale-105">
                å†ä¸€æ¬¡
            </button>
        </div>
    </div>

    <script>
        // Gift Data
        const gifts = [
            { id: 1, name: "è–èª•ç³–æœ", price: 5, icon: "fa-candy-cane", color: "bg-pink-100 text-pink-600" },
            { id: 2, name: "å¡é€šæ“¦è† ", price: 8, icon: "fa-eraser", color: "bg-blue-100 text-blue-600" },
            { id: 3, name: "è–èª•ç­†è¨˜æœ¬", price: 15, icon: "fa-book", color: "bg-yellow-100 text-yellow-600" },
            { id: 4, name: "é¡è‰²ç­†å¥—è£", price: 25, icon: "fa-pencil-alt", color: "bg-purple-100 text-purple-600" },
            { id: 5, name: "æœ±å¤åŠ›", price: 12, icon: "fa-cookie-bite", color: "bg-amber-100 text-amber-700" },
            { id: 6, name: "ç©å…·å°è»Š", price: 30, icon: "fa-car-side", color: "bg-red-100 text-red-600" },
            { id: 7, name: "è–èª•è¥ª", price: 18, icon: "fa-socks", color: "bg-green-100 text-green-600" },
            { id: 8, name: "å¯æ„›è²¼ç´™", price: 6, icon: "fa-sticky-note", color: "bg-indigo-100 text-indigo-600" },
            { id: 9, name: "ç›Šæ™ºç Œåœ–", price: 40, icon: "fa-puzzle-piece", color: "bg-teal-100 text-teal-600" },
            { id: 10, name: "æ¯›çµ¨å…¬ä»”", price: 35, icon: "fa-cat", color: "bg-orange-100 text-orange-600" },
            { id: 11, name: "è–èª•å¸½", price: 10, icon: "fa-hat-santa", color: "bg-red-50 text-red-800" },
            { id: 12, name: "é–“å°º", price: 4, icon: "fa-ruler", color: "bg-gray-100 text-gray-600" }
        ];

        let cart = [];
        const MAX_BUDGET = 100;

        // Initialize UI
        function initShop() {
            const grid = document.getElementById('gift-grid');
            grid.innerHTML = gifts.map(gift => `
                <button onclick="addToCart(${gift.id})" class="gift-card ${gift.color} p-4 rounded-xl border-2 border-transparent hover:border-red-400 flex flex-col items-center justify-center text-center h-32 relative overflow-hidden group">
                    <i class="fas ${gift.icon} text-3xl mb-2 group-hover:scale-110 transition-transform"></i>
                    <div class="font-bold text-gray-800">${gift.name}</div>
                    <div class="text-lg font-black mt-1">$${gift.price}</div>
                    <div class="absolute top-1 right-2 text-xs opacity-50">#${gift.id}</div>
                </button>
            `).join('');
            
            createSnow();
        }

        // Add item to cart
        function addToCart(id) {
            const item = gifts.find(g => g.id === id);
            const currentTotal = cart.reduce((sum, item) => sum + item.price, 0);

            if (currentTotal + item.price > MAX_BUDGET) {
                alert(`Ho Ho Ho! ä¸èƒ½è²·äº†ï¼\nåŠ ä¸Š $${item.price} å°±æœƒè¶…é $100 é ç®—å•¦ï¼\nè«‹åˆªé™¤ä¸€äº›ç‰©å“æˆ–é‡æ–°è¨ˆç®—ã€‚`);
                return;
            }

            cart.push(item);
            updateCartUI();
        }

        // Remove item from cart
        function removeFromCart(index) {
            cart.splice(index, 1);
            updateCartUI();
        }

        // Reset cart
        function resetCart() {
            cart = [];
            updateCartUI();
        }

        // Update the visual cart and math board
        function updateCartUI() {
            const listEl = document.getElementById('selected-items-list');
            const equationEl = document.getElementById('math-equation');
            const totalEl = document.getElementById('total-price');
            const statusEl = document.getElementById('budget-status');

            // 1. Update List
            if (cart.length === 0) {
                listEl.innerHTML = '<p class="text-gray-400 italic text-center py-4">é»æ“Šå·¦å´ç¦®ç‰©åŠ å…¥...</p>';
                equationEl.innerHTML = "0";
                totalEl.innerHTML = "$0";
                statusEl.className = "mt-4 text-center text-sm font-bold py-2 px-4 rounded bg-green-600";
                statusEl.innerHTML = "é ç®—å……è¶³ ($100 ä»¥å…§)";
                return;
            }

            listEl.innerHTML = cart.map((item, index) => `
                <div class="flex justify-between items-center bg-black/20 p-2 rounded animate-[fadeIn_0.3s_ease-in-out]">
                    <span class="flex items-center">
                        <i class="fas ${item.icon} w-6 text-center text-xs mr-2"></i>
                        ${item.name}
                    </span>
                    <div class="flex items-center">
                        <span class="font-mono font-bold mr-3">$${item.price}</span>
                        <button onclick="removeFromCart(${index})" class="text-red-400 hover:text-red-200">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
            `).join('');

            // 2. Update Math Equation
            const prices = cart.map(item => item.price);
            const equationString = prices.join(' + ') + ' = ' + prices.reduce((a,b)=>a+b, 0);
            equationEl.innerHTML = equationString;

            // 3. Update Total
            const total = prices.reduce((a,b) => a + b, 0);
            totalEl.innerHTML = `$${total}`;

            // 4. Update Status Bar
            if (total > 100) {
                statusEl.className = "mt-4 text-center text-sm font-bold py-2 px-4 rounded bg-red-600 animate-pulse";
                statusEl.innerHTML = `âš ï¸ è¶…å‡ºé ç®— $${total - 100}ï¼`;
            } else if (total === 100) {
                statusEl.className = "mt-4 text-center text-sm font-bold py-2 px-4 rounded bg-yellow-600";
                statusEl.innerHTML = "ğŸ¯ å‰›å¥½ $100ï¼å®Œç¾ï¼";
            } else {
                statusEl.className = "mt-4 text-center text-sm font-bold py-2 px-4 rounded bg-green-600";
                statusEl.innerHTML = `é ç®—å…§ (å‰©é¤˜ $${100 - total})`;
            }
        }

        function checkout() {
            if (cart.length === 0) {
                alert("è³¼ç‰©ç±ƒæ˜¯ç©ºçš„å–”ï¼é¸äº›ç¦®ç‰©çµ¦åŒå­¸å§ï¼");
                return;
            }
            const total = cart.reduce((sum, item) => sum + item.price, 0);
            document.getElementById('modal-total').innerText = `$${total}`;
            document.getElementById('modal').classList.remove('hidden');
            document.getElementById('modal').classList.add('flex');
        }

        function closeModal() {
            document.getElementById('modal').classList.add('hidden');
            document.getElementById('modal').classList.remove('flex');
            resetCart();
        }

        // Create Snow Effect
        function createSnow() {
            const container = document.getElementById('snow-container');
            const snowflakeCount = 30;
            
            for (let i = 0; i < snowflakeCount; i++) {
                const flake = document.createElement('div');
                flake.classList.add('snowflake');
                flake.innerHTML = 'â„';
                flake.style.left = Math.random() * 100 + 'vw';
                flake.style.fontSize = (Math.random() * 10 + 10) + 'px';
                flake.style.opacity = Math.random();
                flake.style.animationDuration = (Math.random() * 3 + 2) + 's';
                flake.style.animationDelay = Math.random() * 2 + 's';
                container.appendChild(flake);
            }
        }

        // Initialize
        initShop();
    </script>
</body>
</html>